<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è¯ä¹¦éªŒè¯ä¸­å¿ƒ</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 40px; }
        .valid { color: green; }
        .invalid { color: red; }
        .result { font-size: 1.5em; margin-top: 20px; }
        .debug { font-size: 0.8em; color: gray; text-align: left; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    <h1>ğŸ—ƒï¸ å¼€å‘è€…è´¡çŒ®è¯ä¹¦éªŒè¯ç³»ç»Ÿ</h1>
    <p>è¯·è¾“å…¥è¯ä¹¦ä¸Šçš„å“ˆå¸Œç ï¼Œæˆ–ç›´æ¥æ‰«æè¯ä¹¦äºŒç»´ç è¿›è¡ŒéªŒè¯ã€‚</p>

    <div id="app">
        <input type="text" id="hashInput" placeholder="è¯·è¾“å…¥è¯ä¹¦å“ˆå¸Œç ..." style="width: 400px; padding: 10px;">
        <button onclick="checkHash()">éªŒè¯</button>
        <div id="result"></div>
        <div id="debugInfo" class="debug"></div>
    </div>

    <script>
        // ä»URLä¸­è·å–å“ˆå¸Œå‚æ•°
        const urlParams = new URLSearchParams(window.location.search);
        const hashFromUrl = urlParams.get('hash');
        if (hashFromUrl) {
            document.getElementById('hashInput').value = hashFromUrl;
            checkHash();
        }

        async function checkHash() {
            const inputHash = document.getElementById('hashInput').value.trim();
            const resultDiv = document.getElementById('result');
            const debugDiv = document.getElementById('debugInfo');
            
            // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
            debugDiv.style.display = 'block';
            debugDiv.innerHTML = "<p>å¼€å§‹è¯·æ±‚...</p>";
            
            if (!inputHash) {
                resultDiv.innerHTML = "<p class='invalid'>è¯·è¾“å…¥å“ˆå¸Œç </p>";
                return;
            }

            resultDiv.innerHTML = "<p>æ­£åœ¨éªŒè¯...</p>";

            // å°è¯•ç›´æ¥è®¿é—®ï¼ˆä¸ä½¿ç”¨ä»£ç†ï¼‰
            const verificationFileURL = 'https://raw.githubusercontent.com/soulferryman/Contributors/main/verification.json';
            debugDiv.innerHTML += `<p>è¯·æ±‚URL: ${verificationFileURL}</p>`;

            try {
                const response = await fetch(verificationFileURL);
                debugDiv.innerHTML += `<p>å“åº”çŠ¶æ€: ${response.status} ${response.statusText}</p>`;
                
                if (!response.ok) {
                    throw new Error(`HTTPé”™è¯¯: ${response.status}`);
                }
                
                const text = await response.text();
                debugDiv.innerHTML += `<p>å“åº”å†…å®¹: <pre>${text.substring(0, 200)}...</pre></p>`;
                
                const data = JSON.parse(text);
                debugDiv.innerHTML += `<p>JSONè§£ææˆåŠŸ</p>`;

                // æ£€æŸ¥è¾“å…¥çš„å“ˆå¸Œæ˜¯å¦å­˜åœ¨äºJSONæ•°ç»„ä¸­
                const found = data.find(entry => entry.hash === inputHash);

                if (found) {
                    resultDiv.innerHTML = `
                        <div class="valid">
                            <h2>âœ… è¯ä¹¦æœ‰æ•ˆï¼</h2>
                            <p>æ­¤è¯ä¹¦é¢å‘ç»™ï¼š<strong>${found.github_username}</strong></p>
                            <p>è´¡çŒ®ç­‰çº§ï¼š<strong>${found.level}</strong></p>
                            <p>é¢å‘æ—¥æœŸï¼š<strong>${found.date_issued}</strong></p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="invalid">
                            <h2>âŒ è¯ä¹¦æ— æ•ˆ</h2>
                            <p>æœªèƒ½æ‰¾åˆ°ä¸è¯¥å“ˆå¸Œå€¼åŒ¹é…çš„è¯ä¹¦è®°å½•ã€‚æ­¤è¯ä¹¦å¯èƒ½ä¸ºä¼ªé€ æˆ–æœªè¢«ç™»è®°ã€‚</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error("Fetch error:", error);
                debugDiv.innerHTML += `<p>é”™è¯¯è¯¦æƒ…: ${error.message}</p>`;
                resultDiv.innerHTML = `
                    <div class="invalid">
                        <h2>âš ï¸ éªŒè¯æœåŠ¡æš‚æ—¶ä¸å¯ç”¨</h2>
                        <p>è¯·ç¨åå†è¯•ã€‚é”™è¯¯è¯¦æƒ…: ${error.message}</p>
                        <p>è¯·æ£€æŸ¥æ§åˆ¶å°è·å–æ›´å¤šä¿¡æ¯ã€‚</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
